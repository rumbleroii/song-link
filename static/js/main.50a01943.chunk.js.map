{"version":3,"sources":["App.js","index.js"],"names":["App","useState","currentAccount","setCurrentAccount","msg","setMsg","notif","setNotif","allWaves","setAllWaves","contractAddress","contractABI","abi","checkIfWalletIsConnected","a","window","ethereum","console","log","request","method","accounts","length","account","connectWallet","alert","wave","playlist_url","provider","ethers","providers","Web3Provider","signer","getSigner","wavePortalContract","Contract","getTotalPlaylist","count","toNumber","upload","gasLimit","waveTxn","hash","wait","getAllWaves","waves","wavesCleaned","forEach","push","address","sender","timestamp","Date","url","useEffect","onNewWave","from","message","prevState","on","off","checkSpotifyURL","link","fetch","body","JSON","stringify","headers","then","res","json","works","URL","str","pathname","err","className","onClick","style","marginLeft","color","onSubmit","e","preventDefault","type","placeholder","value","onChange","target","reverse","map","index","etherscan","key","backgroundColor","marginTop","padding","src","width","height","frameBorder","allowFullScreen","allow","toString","href","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.50a01943.chunk.js","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport \"./App.css\";\r\nimport { ethers } from \"ethers\";\r\nimport abi from \"./utils/songLinkPortal.json\";\r\n\r\nconst App = () => {\r\n  const [currentAccount, setCurrentAccount] = useState(\"\");\r\n  const [msg, setMsg] = useState(\"\");\r\n  const [notif, setNotif] = useState(\"\");\r\n  const [allWaves, setAllWaves] = useState();\r\n  const contractAddress = \"0x1794E98C743be19d4a8928BD25340E90C49c1645\";\r\n  const contractABI = abi.abi;\r\n\r\n  const checkIfWalletIsConnected = async () => {\r\n    try {\r\n      const { ethereum } = window;\r\n\r\n      if (!ethereum) {\r\n        console.log(\"Make sure you have metamask!\");\r\n        return;\r\n      } else {\r\n        console.log(\"We have the ethereum object ( metamask )\", ethereum);\r\n      }\r\n\r\n      const accounts = await ethereum.request({ method: \"eth_accounts\" });\r\n\r\n      if (accounts.length !== 0) {\r\n        const account = accounts[0];\r\n        setNotif(`Found an authorized account: ${account}`);\r\n        console.log(\"Found an authorized account: \", account);\r\n        setCurrentAccount(account);\r\n      } else {\r\n        setNotif(\"No authorized account found, Connect Wallet :D\");\r\n        console.log(\"No authorized account found ( ˘︹˘ )\");\r\n      }\r\n\r\n      return true;\r\n    } catch (error) {\r\n      console.log(error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const connectWallet = async () => {\r\n    try {\r\n      const { ethereum } = window;\r\n\r\n      if (!ethereum) {\r\n        alert(\"Get MetaMask!\");\r\n        return;\r\n      }\r\n\r\n      const accounts = await ethereum.request({\r\n        method: \"eth_requestAccounts\",\r\n      });\r\n\r\n      console.log(\"Connected\", accounts[0]);\r\n      setNotif(\"Connected :D\");\r\n      setCurrentAccount(accounts[0]);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  const wave = async (playlist_url) => {\r\n    try {\r\n      console.log(playlist_url);\r\n      setNotif(\"Submitting....\");\r\n      const { ethereum } = window;\r\n\r\n      if (ethereum) {\r\n        const provider = new ethers.providers.Web3Provider(ethereum);\r\n        const signer = provider.getSigner();\r\n        const wavePortalContract = new ethers.Contract(\r\n          contractAddress,\r\n          contractABI,\r\n          signer\r\n        );\r\n\r\n        let count = await wavePortalContract.getTotalPlaylist();\r\n        console.log(\"Retrieved total wave count...\", count.toNumber());\r\n\r\n        const waveTxn = await wavePortalContract.upload(playlist_url, {\r\n          gasLimit: 300000,\r\n        });\r\n        console.log(\"Mining...\", waveTxn.hash);\r\n        setNotif(\"Mining... Do Not Refresh\");\r\n\r\n        await waveTxn.wait();\r\n        console.log(\"Mined -- \", waveTxn.hash);\r\n\r\n        count = await wavePortalContract.getTotalPlaylist();\r\n        console.log(\"Retrieved total wave count...\", count.toNumber());\r\n        setNotif(`Mined! Thanks for the Playlist (ɔ◔‿◔)ɔ ♥`);\r\n      } else {\r\n        console.log(\"Ethereum object doesn't exist!\");\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n      setNotif(\"Transaction Failed\");\r\n    }\r\n  };\r\n\r\n  const getAllWaves = async () => {\r\n    try {\r\n      const { ethereum } = window;\r\n      if (ethereum) {\r\n        const provider = new ethers.providers.Web3Provider(ethereum);\r\n        const signer = provider.getSigner();\r\n        const wavePortalContract = new ethers.Contract(\r\n          contractAddress,\r\n          contractABI,\r\n          signer\r\n        );\r\n\r\n        const waves = await wavePortalContract.getAllWaves();\r\n\r\n        let wavesCleaned = [];\r\n        waves.forEach((wave) => {\r\n          wavesCleaned.push({\r\n            address: wave.sender,\r\n            timestamp: new Date(wave.timestamp * 1000),\r\n            url: wave.playlist_url,\r\n          });\r\n        });\r\n\r\n        \r\n        setAllWaves(wavesCleaned);\r\n      } else {\r\n        console.log(\"Ethereum object doesn't exist!\");\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    let wavePortalContract;\r\n\r\n    const onNewWave = (from, timestamp, message) => {\r\n      console.log(\"NewPlaylist\", from, timestamp, message);\r\n      setAllWaves((prevState) => [\r\n        ...prevState,\r\n        {\r\n          address: from,\r\n          timestamp: new Date(timestamp * 1000),\r\n          message: message,\r\n        },\r\n      ]);\r\n    };\r\n\r\n    if (window.ethereum) {\r\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\r\n      const signer = provider.getSigner();\r\n\r\n      wavePortalContract = new ethers.Contract(\r\n        contractAddress,\r\n        contractABI,\r\n        signer\r\n      );\r\n      wavePortalContract.on(\"NewPlaylist\", onNewWave);\r\n    }\r\n\r\n    return () => {\r\n      if (wavePortalContract) {\r\n        wavePortalContract.off(\"NewPlaylist\", onNewWave);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (checkIfWalletIsConnected()) {\r\n      getAllWaves();\r\n    }\r\n  }, []);\r\n\r\n  const checkSpotifyURL = async(link) => {\r\n    fetch(\"https://spotifyverifyapi.herokuapp.com/\", {\r\n      method: \"POST\",\r\n      body: JSON.stringify({\r\n        url: link.msg,\r\n      }),\r\n      headers: {\r\n        \"Content-type\": \"application/json; charset=UTF-8\",\r\n      },\r\n    })\r\n      .then((res) => res.json())\r\n      .then((json) => {\r\n        if (json.works == true) {\r\n          const url = new URL(link.msg);\r\n          const str = `https://open.spotify.com/embed${url.pathname}`;\r\n          wave(str);\r\n        } else {\r\n          setNotif(json.err);\r\n        }\r\n      });\r\n}\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    const message = { msg };\r\n    checkSpotifyURL(message);\r\n  };\r\n\r\n  return (\r\n    <div className=\"mainContainer\">\r\n      <div className=\"dataContainer\">\r\n        <div className=\"header\">🎵 Song Link !</div>\r\n\r\n        <div className=\"bio\">Your Playlist on BlockChain!</div>\r\n        <br></br>\r\n\r\n        <div className=\"alert\">{notif}</div>\r\n\r\n        <div className=\"bio\">\r\n          Paste link of your favorite Spotify Playlist. Cooldown time of 15 minutes, if transaction fails, please try after 15 minutes\r\n        </div>\r\n\r\n        {!currentAccount && (\r\n          <button className=\"waveButton\" onClick={connectWallet}>\r\n            Connect Wallet\r\n          </button>\r\n        )}\r\n        <div className=\"mainContainer\">\r\n          Total Number of Playlist:{\" \"}\r\n          <span\r\n            style={{\r\n              marginLeft:\"5px\",\r\n              color: \"red\",\r\n            }}\r\n          >\r\n            {allWaves?.length}\r\n          </span>\r\n        </div>\r\n        {currentAccount && (\r\n          <form className=\"dataContainer\" onSubmit={handleSubmit}>\r\n            <div className=\"mainContainer\">\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Spotify Playlist URL\"\r\n                value={msg}\r\n                onChange={(e) => setMsg(e.target.value)}\r\n              />\r\n            </div>\r\n            <button className=\"waveButton\">Submit</button>\r\n          </form>\r\n        )}\r\n\r\n        { allWaves?.reverse().map((wave, index) => {\r\n          const etherscan =\r\n            \"https://rinkeby.etherscan.io/address/\" + wave.address;\r\n          return (\r\n            <div\r\n              key={index}\r\n              style={{\r\n                backgroundColor: \"OldLace\",\r\n                marginTop: \"20px\",\r\n                padding: \"30px\",\r\n              }}\r\n            >\r\n              <iframe\r\n                src={wave.url}\r\n                width=\"100%\"\r\n                height=\"380\"\r\n                frameBorder=\"0\"\r\n                allowFullScreen=\"\"\r\n                allow=\"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture\"\r\n              ></iframe>\r\n              <div>Address: {wave.address}</div>\r\n              <div>Time: {wave.timestamp.toString()}</div>\r\n              <span>\r\n                Etherscan Link: <a href={etherscan}>{etherscan}</a>\r\n              </span>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n"],"sourceRoot":""}